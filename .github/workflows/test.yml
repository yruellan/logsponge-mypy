name: Test Mypy Plugin

on: [push, pull_request]

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Install uv
        uses: astral-sh/setup-uv@v5
        with:
          # Pin to the Python version required by your project
          python-version: "3.12"
          # specific to your pyproject.toml settings
          enable-cache: true
          cache-dependency-glob: "uv.lock"

      - name: Install dependencies
        run: |
          # Installs dependencies exactly as specified in uv.lock
          # The --frozen flag ensures CI fails if uv.lock is out of sync with pyproject.toml
          uv sync --frozen

      - name: Run Tests
        # 'uv run' automatically executes the command in the project's virtual environment
        run: uv run pytest tests/ -v